@using ExaminerPaymentSystem.ViewModels.Examiners
@model TandSViewModel
@{
    ViewBag.Title = "TandS Accounts Approval";
}

<link href="~/css/tands.css" rel="stylesheet" />



<style>
    .containera {
        border: 1px solid #153355; /* Set border width and color */
        padding: 10px; /* Add padding inside the container */
        border-radius: 10px; /* Add border radius for rounded corners */
    }
    /* Styles for form */


    .approve {
        background-color: #4CAF50; /* Green */
        color: white;
        border: none;
    }

    .reject {
        background-color: #f44336; /* Red */
        color: white;
        border: none;
    }

    .timeline {
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
    }

    .timeline-header {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
        text-align: center;
    }

    .timeline-item {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid #dee2e6;
    }

        .timeline-item:last-child {
            border-bottom: none;
        }

    .timeline-label {
        font-weight: bold;
        color: #343a40;
    }

    .timeline-content {
        color: #495057;
    }
</style>

@if (User.IsInRole("Accounts"))
{

    @section Scripts {
    <script>
        $(document).ready(function () {
        @if (TempData["SuccessMessage"] != null)
            {
                <text>
                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: '@TempData["SuccessMessage"]',
                            showConfirmButton: false,
                            timer: 2000
                        });
                </text>
            }

                                                });
        </script>
    }


    @if (ViewBag.AccountsStatus == "Pending")
    {

        <div class="container py-3 mb-3  rounded-3 shadow-sm border" style="padding: 30px;">



            <div>

                <a class="btn mb-3 text-white" style="background-color: #153355;" asp-controller="Transcribers" asp-action="TandSAccountsList">
                    <i class="fas fa-arrow-left"></i> Back To List
                </a>
            </div>
        </div>





        <div class="container py-3  mb-3 rounded-3 shadow-sm border" style="padding: 30px;">
               <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="created-date" style="font-size: 0.9rem; color: #666;">
            Created Date: @Model.Date
        </div>
        <div class="header">
            <h4 class="font-weight-bold text-center">Travelling and Subsistence Claim Report</h4>
        </div>
        <div style="width: 100px;">&nbsp;</div> <!-- Spacer for alignment -->
    </div>


            <div class="card p-2 mb-3 shadow-sm border">
                <div class="row">
                    <div class="col-md-9 mb-3">
                        <div class="card p-1 shadow-sm border rounded">
                            <div class="card-header bg-secondary text-white py-1">
                                <h6 class="mb-0 small">Claim Details</h6>
                            </div>
                            <div class="card-body p-2">
                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Full Name:</span>
                                        <span class="small">@Model.EMS_EXAMINER_NAME @Model.EMS_LAST_NAME</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">National ID:</span>
                                        <span class="small">@Model.EMS_NATIONAL_ID</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Subject:</span>
                                        <span class="small">@Model.EMS_SUB_SUB_ID / @Model.EMS_PAPER_CODE</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Level:</span>
                                        <span class="small">@Model.EMS_LEVEL_OF_EXAM_MARKED</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Bank (NOSTRO):</span>
                                        <span class="small">@Model.EMS_BANK_NAME_FCA</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Account No. (NOSTRO):</span>
                                        <span class="small">@Model.EMS_ACCOUNT_NO_FCA</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Bank (ZWG):</span>
                                        <span class="small">@Model.EMS_BANK_NAME_ZWL</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Account No. (ZWG):</span>
                                        <span class="small">@Model.EMS_ACCOUNT_NO_ZWL</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Purpose:</span>
                                        <span class="small">@Model.EMS_PURPOSEOFJOURNEY</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="font-weight-bold small w-50">Venue:</span>
                                        <span class="small">@Model.EMS_VENUE</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Work Address and Contact Section -->
                    <div class="col-md-3 mb-4">
                        <div class="card p-2 shadow-sm border rounded">
                            <div class="card-body">
                                <h6 class="font-weight-bold text-primary">
                                    <i class="fa fa-map-marker-alt"></i> Work Address
                                </h6>
                                <p class="mb-1 small"><i class="fa fa-home"></i> @Model.EMS_WORK_ADD1</p>
                                <p class="mb-1 small"><i class="fa fa-city"></i> @Model.EMS_WORK_ADD2</p>
                                <p class="mb-3 small"><i class="fa fa-building"></i> @Model.EMS_WORK_ADD3</p>

                                <h6 class="font-weight-bold text-primary">
                                    <i class="fa fa-phone"></i> Contact
                                </h6>
                                <p class="mb-0 small"><i class="fa fa-phone-alt"></i> @Model.EMS_PHONE_HOME</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>



            <div class="card border-light shadow-sm rounded">
                <div class="card-header bg-secondary text-white">
                    <h6 class="mb-0">Travelling and Subsistence Claim Details</h6>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm">
                        <thead class="thead-dark">
                            <tr>
                                <th>Date</th>
                                <th>Departure Time</th>
                                <th>Arrival Time</th>
                                <th>Place (From/To)</th>
                                <th>Busfare</th>
                                <th>Accommodation</th>
                                <th>Lunch</th>
                                <th>Dinner</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                            {
                                foreach (var detail in ViewBag.TandSDetails)
                                {
                                    <tr>
                                        <td>@detail.EMS_DATE</td>
                                        <td>@detail.EMS_DEPARTURE</td>
                                        <td>@detail.EMS_ARRIVAL</td>
                                        <td>@detail.EMS_PLACE</td>
                                        <td>@detail.EMS_BUSFARE</td>
                                        <td>@detail.EMS_ACCOMMODATION</td>
                                        <td>@detail.EMS_LUNCH</td>
                                        <td>@detail.EMS_DINNER</td>
                                        <td>@detail.EMS_TOTAL</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="9" class="text-center">No data available</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" class="font-weight-bold text-right">Total Expenses</td>
                                <td class="font-weight-bold">@ViewBag.TotalBusfare</td>
                                <td class="font-weight-bold">@ViewBag.TotalAccommodation</td>
                                <td class="font-weight-bold">@ViewBag.TotalLunch</td>
                                <td class="font-weight-bold">@ViewBag.TotalDinner</td>
                                <td class="font-weight-bold">@ViewBag.TotalTotal</td>
                            </tr>
                            <tr>
                                <td colspan="9" class="font-weight-bold">Less advances/prepayments received in respect of this claim</td>
                            </tr>
                            <tr>
                                <td colspan="8" class="font-weight-bold text-right">Amount Due to Employee</td>
                                <td class="font-weight-bold">@ViewBag.TotalTotal</td>
                            </tr>
                        </tfoot>
                    </table>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped table-hover mt-5">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Product</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-center">Unit Price</th>
                                    <th class="text-end">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.TandSAdvance != null)
                                {
                                    var advance = ViewBag.TandSAdvance as TandSAdvance;

                                    if (advance.ADV_TEAS.HasValue && ViewBag.FEE_TEA != null)
                                    {
                                        decimal teasAmount = advance.ADV_TEAS.Value;
                                        decimal feeTea = (decimal)ViewBag.FEE_TEA;
                                        decimal totalTeas = teasAmount * feeTea;
                                        <tr>
                                            <td>Teas</td>
                                            <td class="text-center">@teasAmount</td>
                                            <td class="text-center">@feeTea.ToString("F2")</td>
                                            <td class="text-end">@totalTeas.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADV_BREAKFAST.HasValue && ViewBag.FEE_BREAKFAST != null)
                                    {
                                        decimal breakfastAmount = advance.ADV_BREAKFAST.Value;
                                        decimal feeBreakfast = (decimal)ViewBag.FEE_BREAKFAST;
                                        decimal totalBreakfast = breakfastAmount * feeBreakfast;
                                        <tr>
                                            <td>Breakfast</td>
                                            <td class="text-center">@breakfastAmount</td>
                                            <td class="text-center">@feeBreakfast.ToString("F2")</td>
                                            <td class="text-end">@totalBreakfast.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADV_TRANSPORT.HasValue && ViewBag.FEE_TRANSPORT != null)
                                    {
                                        decimal transportAmount = advance.ADV_TRANSPORT.Value;
                                        decimal feeTransport = (decimal)ViewBag.FEE_TRANSPORT;
                                        <tr>
                                            <td>Transport</td>
                                            <td class="text-center">@transportAmount</td>
                                            <td class="text-center">@feeTransport.ToString("F2")</td>
                                            <td class="text-end">@((transportAmount * feeTransport).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_ACCOMMODATION_RES.HasValue && ViewBag.FEE_ACCOMMODATION_RES != null)
                                    {
                                        decimal accommodationResAmount = advance.ADV_ACCOMMODATION_RES.Value;
                                        decimal feeAccommodationRes = (decimal)ViewBag.FEE_ACCOMMODATION_RES;
                                        <tr>
                                            <td>Accommodation (Res)</td>
                                            <td class="text-center">@accommodationResAmount</td>
                                            <td class="text-center">@feeAccommodationRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationResAmount * feeAccommodationRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_ACCOMMODATION_NONRES.HasValue && ViewBag.FEE_ACCOMMODATION_NONRES != null)
                                    {
                                        decimal accommodationNonResAmount = advance.ADV_ACCOMMODATION_NONRES.Value;
                                        decimal feeAccommodationNonRes = (decimal)ViewBag.FEE_ACCOMMODATION_NONRES;
                                        <tr>
                                            <td>Accommodation (Non-Res)</td>
                                            <td class="text-center">@accommodationNonResAmount</td>
                                            <td class="text-center">@feeAccommodationNonRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationNonResAmount * feeAccommodationNonRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_LUNCH.HasValue && ViewBag.FEE_LUNCH != null)
                                    {
                                        decimal lunchAmount = advance.ADV_LUNCH.Value;
                                        decimal feeLunch = (decimal)ViewBag.FEE_LUNCH;
                                        <tr>
                                            <td>Lunch</td>
                                            <td class="text-center">@lunchAmount</td>
                                            <td class="text-center">@feeLunch.ToString("F2")</td>
                                            <td class="text-end">@((lunchAmount * feeLunch).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_DINNER.HasValue && ViewBag.FEE_DINNER != null)
                                    {
                                        decimal dinnerAmount = advance.ADV_DINNER.Value;
                                        decimal feeDinner = (decimal)ViewBag.FEE_DINNER;
                                        <tr>
                                            <td>Dinner</td>
                                            <td class="text-center">@dinnerAmount</td>
                                            <td class="text-center">@feeDinner.ToString("F2")</td>
                                            <td class="text-end">@((dinnerAmount * feeDinner).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_OVERNIGHTALLOWANCE.HasValue && ViewBag.FEE_OVERNIGHTALLOWANCE != null)
                                    {
                                        decimal overnightAllowanceAmount = advance.ADV_OVERNIGHTALLOWANCE.Value;
                                        decimal feeOvernightAllowance = (decimal)ViewBag.FEE_OVERNIGHTALLOWANCE;
                                        <tr>
                                            <td>Overnight Allowance</td>
                                            <td class="text-center">@overnightAllowanceAmount</td>
                                            <td class="text-center">@feeOvernightAllowance.ToString("F2")</td>
                                            <td class="text-end">@((overnightAllowanceAmount * feeOvernightAllowance).ToString("F2"))</td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="4" class="text-center">No data available</td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3" class="text-end font-weight-bold">Total</td>
                                    <td class="text-end font-weight-bold">@ViewBag.TandSAdvance?.ADV_TOTAL?.ToString("F2")</td>
                                </tr>
                            </tfoot>
                        </table>

                    </div>

                </div>
            </div>



            <div class="container my-4">
                <div class="d-flex justify-content-end align-items-center py-3 px-4 bg-light shadow-sm rounded">
                    <span class="text-black fw-semibold me-2">Overall Total:</span>
                    <span class="text-primary fw-bold ">
                        @String.Format("{0:C}", Model.EMS_TOTAL)
                    </span>
                </div>
            </div>


        </div>


        <div class="container py-3 mb-3 rounded-3 shadow-sm border bg-light" style="padding: 30px;">
            <label class="mb-3 custom-label-note fw-bold">Accounting Adjusted Details</label>

            @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
            {
                <form asp-action="UpdateTandS" method="post">

                    <input type="hidden" name="EMS_NATIONAL_ID" value="@Model.EMS_NATIONAL_ID" />
                    <input type="hidden" name="TANDSCODE" value="@Model.TANDSCODE" />
                    <input type="hidden" name="EMS_EXAMINER_CODE" value="@Model.EMS_EXAMINER_CODE" />
                    <input type="hidden" name="EMS_SUBKEY" value="@Model.EMS_SUBKEY" />

                    <div class="table-responsive mt-3 bg-secondary text-white rounded p-3">
                        <table class="table table-bordered table-hover text-white">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Date</th>
                                    <th>Departure Time</th>
                                    <th>Arrival Time</th>
                                    <th>Place (From/To)</th>
                                    <th>Busfare</th>
                                    <th>Accommodation</th>
                                    <th>Lunch</th>
                                    <th>Dinner</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                                {
                                    var index = 0;
                                    foreach (var detail in ViewBag.TandSDetails)
                                    {
                                        <tr>
                                            <input type="hidden" name="TANDSDETAILS[@index].Id" value="@detail.Id" />
                                            <input type="hidden" name="TANDSDETAILS[@index].EMS_DATE" value="@detail.EMS_DATE" />
                                            <input type="hidden" name="TANDSDETAILS[@index].EMS_DEPARTURE" value="@detail.EMS_DEPARTURE" />
                                            <input type="hidden" name="TANDSDETAILS[@index].EMS_ARRIVAL" value="@detail.EMS_ARRIVAL" />
                                            <input type="hidden" name="TANDSDETAILS[@index].EMS_PLACE" value="@detail.EMS_PLACE" />
                                            <input type="hidden" name="TANDSDETAILS[@index].EMS_NATIONAL_ID" value="@detail.EMS_NATIONAL_ID" />

                                            <td>@detail.EMS_DATE</td>
                                            <td>@detail.EMS_DEPARTURE</td>
                                            <td>@detail.EMS_ARRIVAL</td>
                                            <td>@detail.EMS_PLACE</td>



                                            <td>
                                                <input type="text" class="form-control form-control-sm busfare-value" name="TANDSDETAILS[@index].EMS_BUSFARE" value="@detail.EMS_BUSFARE" oninput="calculateRowTotal()" />
                                            </td>
                                            <td>
                                                <input type="text" class=" form-control form-control-sm accommodation-value" name="TANDSDETAILS[@index].EMS_ACCOMMODATION" value="@detail.EMS_ACCOMMODATION" oninput="calculateRowTotal()" />
                                            </td>
                                            <td>
                                                <input type="text" class=" form-control form-control-sm lunch-value" name="TANDSDETAILS[@index].EMS_LUNCH" value="@detail.EMS_LUNCH" oninput="calculateRowTotal()" />
                                            </td>
                                            <td>
                                                <input type="text" class="form-control form-control-sm dinner-value" name="TANDSDETAILS[@index].EMS_DINNER" value="@detail.EMS_DINNER" oninput="calculateRowTotal()" />
                                            </td>
                                            <td>
                                                <input type="text" class="form-control form-control-sm total-value" name="TANDSDETAILS[@index].EMS_TOTAL" value="@detail.EMS_TOTAL" readonly />
                                            </td>
                                        </tr>
                                        index++;
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="9" class="text-center">No data available</td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3"></td>
                                    <td class="font-weight-bold text-right">TOTAL EXPENSES</td>
                                    <td id="totalBusfare" class="font-weight-bold">@ViewBag.TotalBusfare</td>
                                    <td id="totalAccommodation" class="font-weight-bold">@ViewBag.TotalAccommodation</td>
                                    <td id="totalLunch" class="font-weight-bold">@ViewBag.TotalLunch</td>
                                    <td id="totalDinner" class="font-weight-bold">@ViewBag.TotalDinner</td>
                                    <td id="grandTotal" class="font-weight-bold">@ViewBag.TotalTotal</td>
                                </tr>
                                <tr>
                                    <td colspan="9" class="font-weight-bold text-center">Less advances/prepayments received in respect of this claim</td>
                                </tr>
                                <tr>
                                    <td colspan="8" class="fw-bold text-right">Amount Due to Employee</td>
                                    <td id="grandTotal2" class="fw-bold">@ViewBag.TotalTotal</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div class="bg-secondary text-white rounded p-3 mt-3">
                        <div class="row">
                            <!-- Accommodation -->
                            <div class="col-md-6">
                                <label class="mb-3 custom-label-note">Accommodation</label>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="nonres">Non Res:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="nonres" name="unproved_price" readonly value="@ViewBag.FEE_ACCOMMODATION_NONRES" />
                                            <input type="text" class="form-control quantity" id="unproved_quantity" name="TANDSADVANCE.ADJ_ADV_ACCOMMODATION_NONRES" value="@(ViewBag.TandSAdvance?.ADV_ACCOMMODATION_NONRES?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="res">Res:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="res" name="company_provided_price" readonly value="@ViewBag.FEE_ACCOMMODATION_RES" />
                                            <input type="text" class="form-control quantity" id="company_provided_quantity" name="TANDSADVANCE.ADJ_ADV_ACCOMMODATION_RES" value="@(ViewBag.TandSAdvance?.ADV_ACCOMMODATION_RES?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Transport -->
                            <div class="col-md-6">
                                <label class="mb-3 custom-label-note">Transport</label>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="transport">BusFare:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="transport" readonly name="transport" value="@ViewBag.FEE_TRANSPORT" />
                                            <input type="text" class="form-control quantity" id="transport_quantity" name="TANDSADVANCE.ADJ_ADV_TRANSPORT" value="@(ViewBag.TandSAdvance?.ADV_TRANSPORT?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <!-- Meals -->
                            <div class="col-md-6">
                                <label class="mb-3 custom-label-note">Meals</label>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="dinner">Dinner:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="dinner" name="dinner" readonly value="@ViewBag.FEE_DINNER" />
                                            <input type="number" class="form-control quantity" id="dinner_quantity" name="TANDSADVANCE.ADJ_ADV_DINNER" value="@(ViewBag.TandSAdvance?.ADV_DINNER?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>

                                    <div class="form-group col-md-6">
                                        <label for="breakfast">Breakfast:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="breakfast" readonly name="breakfast" value="@ViewBag.FEE_BREAKFAST" />
                                            <input type="text" class="form-control quantity" id="breakfast_quantity" name="TANDSADVANCE.ADJ_ADV_BREAKFAST" value="@(ViewBag.TandSAdvance?.ADV_BREAKFAST?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label class="mb-3 custom-label-note">Extras</label>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="teas">Teas:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="teas" readonly name="teas" value="@ViewBag.FEE_TEA" />
                                            <input type="text" class="form-control quantity" id="teas_quantity" name="TANDSADVANCE.ADJ_ADV_TEA" value="@(ViewBag.TandSAdvance?.ADV_TEAS?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>

                                    <div class="form-group col-md-6">
                                        <label for="overnight">Overnight Allowance:</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="text" class="form-control fee" id="overnight" name="overnight" readonly value="@ViewBag.FEE_OVERNIGHTALLOWANCE" />
                                            <input type="text" class="form-control quantity" id="overnight_quantity" name="TANDSADVANCE.ADJ_ADV_OVERNIGHTALLOWANCE" value="@(ViewBag.TandSAdvance?.ADV_OVERNIGHTALLOWANCE?.ToString("0") ?? "0")" oninput="this.value = this.value.replace(/[^0-9]/g, '');" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: right; font-weight: bold; margin-top: 20px;">
                            <p>Total : <span id="total" style="font-weight:bold;">$@ViewBag.TotalAdv.ToString("F2")</span></p>
                        </div>
                    </div>




                    <div class="containera mt-2">
                        <div style="text-align: right; font-weight: bold; margin-top: 20px;">
                            Overall Total:
                            <span id="finaltotal">
                                @((decimal.Parse(ViewBag.TotalTotal.ToString()) + decimal.Parse(ViewBag.TotalAdv.ToString())).ToString("C"))
                            </span>
                        </div>
                    </div>

                    <script src="~/js/tablefixer.js"></script>

                    <script>
                        // Function to calculate the overall total
                        function calculateOverallTotal() {
                            // Get the totals
                            const grandTotal = parseFloat($('#grandTotal2').text()) || 0;
                            const additionalTotal = parseFloat($('#total').text().replace('$', '')) || 0;

                            // Calculate the overall total
                            const overallTotal = grandTotal + additionalTotal;

                            // Update the final total in the UI
                            $('#finaltotal').text('$' + overallTotal.toFixed(2));
                        }

                        // Event listener to trigger calculations dynamically
                        $(document).on('input', '.fee, .quantity, .busfare-value, .accommodation-value, .lunch-value, .dinner-value', function () {
                            calculateRowTotal();       // Update row and grand totals
                            calculateOverallTotal();   // Update the overall total
                        });

                        // Initial calculation to ensure values are updated on page load
                        $(document).ready(function () {
                            calculateRowTotal();
                            calculateOverallTotal();
                        });
                    </script>




                    <div class="container-fluid mt-3">
                        <div class="row g-2">
                            <!-- Save Button -->
                            <div class="col">
                                <button type="submit" class="btn  w-100 text-white" style="background-color: #153355;">
                                    <i class="fas fa-save me-1"></i>Save
                                </button>
                            </div>

                            <!-- Reject Button -->
                            <div class="col">
                                <button type="button" class="btn btn-danger  w-100" onclick="rejectClaimm()">
                                    <i class="fas fa-times-circle me-1"></i>Reject
                                </button>
                            </div>

                            <!-- Cancel Button -->
                            <div class="col">
                                <a asp-action="Index" class="btn btn-outline-secondary  w-100">
                                    <i class="fas fa-times me-1"></i>Cancel
                                </a>
                            </div>
                        </div>
                    </div>
                </form>
            }
            else
            {
                <div class="alert alert-warning text-center">No details available to adjust.</div>
            }
        </div>






        <div class="card border-light shadow-sm rounded">
            <div class="container py-3">
                <label class="mb-3 custom-label-note fw-bold">Uploaded Files</label>
                @if (ViewBag.TandSFile != null && (ViewBag.TandSFile as IEnumerable<TandSFile>).Any())
                {
                    <ul class="list-group list-group-flush">
                        @foreach (var file in ViewBag.TandSFile as IEnumerable<TandSFile>)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    @{
                                        var fileExtension = System.IO.Path.GetExtension(file.FileName).ToLower();
                                        var iconClass = "fa-file";
                                        switch (fileExtension)
                                        {
                                            case ".pdf":
                                                iconClass = "fa-file-pdf text-danger";
                                                break;
                                            case ".doc":
                                            case ".docx":
                                                iconClass = "fa-file-word text-primary";
                                                break;
                                            case ".xls":
                                            case ".xlsx":
                                                iconClass = "fa-file-excel text-success";
                                                break;
                                            case ".jpg":
                                            case ".jpeg":
                                            case ".png":
                                                iconClass = "fa-file-image text-warning";
                                                break;
                                            default:
                                                iconClass = "fa-file text-secondary";
                                                break;
                                        }
                                    }
                                    <i class="fas @iconClass fa-2x me-3"></i>
                                    <div>
                                        <span class="fw-semibold">@file.FileName</span>
                                        <p class="text-muted small mb-0">Currency: @file.Currency</p>
                                    </div>
                                </div>
                                <a href="@Url.Action("DownloadFile", "TandS", new { fileName = file.FileName })" class="btn btn-sm btn-primary">
                                    <i class="fas fa-download"></i> Download
                                </a>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-center text-muted fst-italic">No files available.</p>
                }
            </div>
        </div>










        @if (User.IsInRole("Accounts"))
        {

            <div class="containera mt-3">
                <div class="container">
                    <div class="timeline">
                        <div class="timeline-header text-black">Timeline</div>
                        
            @if (@Model.SUBJECT_MANAGER_STATUS != null)
            {
            <div class="containera">
            <div class="timeline-item">
            <span class="timeline-label">Status By:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_STATUS_BY</span>
            </div>
            <div class="timeline-item">
            <span class="timeline-label">Date:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_DATE</span>
            </div>
            @if (@Model.SUBJECT_MANAGER_STATUS == "Recommended")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:green;">@Model.SUBJECT_MANAGER_STATUS</span>
            </div>
            }
            else if (@Model.SUBJECT_MANAGER_STATUS == "Rejected")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:red;">@Model.SUBJECT_MANAGER_STATUS</span>
            </div>
            }

            <div class="timeline-item">
            <span class="timeline-label">Comment:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_COMMENT</span>
            </div>
            </div>
            }
      

                        @if (@Model.CENTRE_SUPERVISOR_STATUS != null)
                        {
                            <div class="containera">
                                <div class="timeline-item">
                                    <span class="timeline-label">Status By:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_STATUS_BY</span>
                                </div>
                                <div class="timeline-item">
                                    <span class="timeline-label">Date:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_DATE</span>
                                </div>
                                @if (@Model.CENTRE_SUPERVISOR_STATUS == "Approved")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:green;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                    </div>
                                }
                                else if (@Model.CENTRE_SUPERVISOR_STATUS == "Rejected")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:red;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                    </div>

                                }

                                <div class="timeline-item">
                                    <span class="timeline-label">Comment:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_COMMENT</span>
                                </div>
                            </div>
                        }

                        @if (@Model.ReturnBackStatus != null)
                        {
                            <div class="containera mt-3" style="background-color:red;color:white;">
                                <div class="timeline-item">
                                    <span class="timeline-label text-white">Status By:</span>
                                    <span class="timeline-content text-white">@Model.ReturnBackBy</span>
                                </div>
                                <div class="timeline-item">
                                    <span class="timeline-label text-white">Date:</span>
                                    <span class="timeline-content text-white">@Model.ReturnDate</span>
                                </div>
                                @if (@Model.ReturnBackStatus == "Returned")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label text-white">Status:</span>
                                        <span class="timeline-content text-white" style="color:red;">@Model.ReturnBackStatus</span>
                                    </div>
                                }


                                <div class="timeline-item">
                                    <span class="timeline-label text-white">Comment:</span>
                                    <span class="timeline-content text-white">@Model.ReturnComment</span>
                                </div>
                            </div>
                        }


                    </div>
                </div>

            </div>

        }










    }
    else
    {




        <div class="container py-3 mb-3  rounded-3 shadow-sm border" style="padding: 30px;">

            <div>
                <a class="btn mb-3 text-white" style="background-color: #153355;" asp-controller="Transcribers" asp-action="TandSAccountsList">
                    <i class="fas fa-arrow-left"></i> Back To List
                </a>
            </div>
        </div>




        <div class="container py-3  mb-3 rounded-3 shadow-sm border" style="padding: 30px;">
             <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="created-date" style="font-size: 0.9rem; color: #666;">
            Created Date: @Model.Date
        </div>
        <div class="header">
            <h4 class="font-weight-bold text-center">Travelling and Subsistence Claim Report</h4>
        </div>
        <div style="width: 100px;">&nbsp;</div> <!-- Spacer for alignment -->
    </div>


            <div class="card p-2 mb-3 shadow-sm border">
                <div class="row">
                    <div class="col-md-9 mb-3">
                        <div class="card p-1 shadow-sm border rounded">
                            <div class="card-header bg-secondary text-white py-1">
                                <h6 class="mb-0 small">Claim Details</h6>
                            </div>
                            <div class="card-body p-2">
                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Full Name:</span>
                                        <span class="small">@Model.EMS_EXAMINER_NAME @Model.EMS_LAST_NAME</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">National ID:</span>
                                        <span class="small">@Model.EMS_NATIONAL_ID</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Subject:</span>
                                        <span class="small">@Model.EMS_SUB_SUB_ID / @Model.EMS_PAPER_CODE</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Level:</span>
                                        <span class="small">@Model.EMS_LEVEL_OF_EXAM_MARKED</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Bank (NOSTRO):</span>
                                        <span class="small">@Model.EMS_BANK_NAME_FCA</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Account No. (NOSTRO):</span>
                                        <span class="small">@Model.EMS_ACCOUNT_NO_FCA</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Bank (ZWG):</span>
                                        <span class="small">@Model.EMS_BANK_NAME_ZWL</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Account No. (ZWG):</span>
                                        <span class="small">@Model.EMS_ACCOUNT_NO_ZWL</span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Purpose:</span>
                                        <span class="small">@Model.EMS_PURPOSEOFJOURNEY</span>
                                    </div>
                                    <div class="col-md-6 mb-1 d-flex">
                                        <span class="fw-bold small w-50">Venue:</span>
                                        <span class="small">@Model.EMS_VENUE</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Work Address and Contact Section -->
                    <div class="col-md-3 mb-4">
                        <div class="card p-2 shadow-sm border rounded">
                            <div class="card-body">
                                <h6 class="fw-bold text-primary">
                                    <i class="fa fa-map-marker-alt"></i> Work Address
                                </h6>
                                <p class="mb-1 small"><i class="fa fa-home"></i> @Model.EMS_WORK_ADD1</p>
                                <p class="mb-1 small"><i class="fa fa-city"></i> @Model.EMS_WORK_ADD2</p>
                                <p class="mb-3 small"><i class="fa fa-building"></i> @Model.EMS_WORK_ADD3</p>

                                <h6 class="fw-bold text-primary">
                                    <i class="fa fa-phone"></i> Contact
                                </h6>
                                <p class="mb-0 small"><i class="fa fa-phone-alt"></i> @Model.EMS_PHONE_HOME</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>






            <div class="card border-light shadow-sm rounded">
                <div class="card-header bg-secondary text-white">
                    <h6 class="mb-0">Travelling and Subsistence Claim Details</h6>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm">
                        <thead class="thead-dark">
                            <tr>
                                <th>Date</th>
                                <th>Departure Time</th>
                                <th>Arrival Time</th>
                                <th>Place (From/To)</th>
                                <th>Busfare</th>
                                <th>Accommodation</th>
                                <th>Lunch</th>
                                <th>Dinner</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                            {
                                foreach (var detail in ViewBag.TandSDetails)
                                {
                                    <tr>
                                        <td>@detail.EMS_DATE</td>
                                        <td>@detail.EMS_DEPARTURE</td>
                                        <td>@detail.EMS_ARRIVAL</td>
                                        <td>@detail.EMS_PLACE</td>
                                        <td>@detail.EMS_BUSFARE</td>
                                        <td>@detail.EMS_ACCOMMODATION</td>
                                        <td>@detail.EMS_LUNCH</td>
                                        <td>@detail.EMS_DINNER</td>
                                        <td>@detail.EMS_TOTAL</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="9" class="text-center">No data available</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" class="fw-bold text-right">Total Expenses</td>
                                <td class="fw-bold">@ViewBag.TotalBusfare</td>
                                <td class="fw-bold">@ViewBag.TotalAccommodation</td>
                                <td class="fw-bold">@ViewBag.TotalLunch</td>
                                <td class="fw-bold">@ViewBag.TotalDinner</td>
                                <td class="fw-bold">@ViewBag.TotalTotal</td>
                            </tr>
                            <tr>
                                <td colspan="9" class="fw-bold">Less advances/prepayments received in respect of this claim</td>
                            </tr>
                            <tr>
                                <td colspan="8" class="fw-bold text-right">Amount Due to Employee</td>
                                <td class="fw-bold">@ViewBag.TotalTotal</td>
                            </tr>
                        </tfoot>
                    </table>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped table-hover mt-5">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Product</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-center">Unit Price</th>
                                    <th class="text-end">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.TandSAdvance != null)
                                {
                                    var advance = ViewBag.TandSAdvance as TandSAdvance;

                                    if (advance.ADV_TEAS.HasValue && ViewBag.FEE_TEA != null)
                                    {
                                        decimal teasAmount = advance.ADV_TEAS.Value;
                                        decimal feeTea = (decimal)ViewBag.FEE_TEA;
                                        decimal totalTeas = teasAmount * feeTea;
                                        <tr>
                                            <td>Teas</td>
                                            <td class="text-center">@teasAmount</td>
                                            <td class="text-center">@feeTea.ToString("F2")</td>
                                            <td class="text-end">@totalTeas.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADV_BREAKFAST.HasValue && ViewBag.FEE_BREAKFAST != null)
                                    {
                                        decimal breakfastAmount = advance.ADV_BREAKFAST.Value;
                                        decimal feeBreakfast = (decimal)ViewBag.FEE_BREAKFAST;
                                        decimal totalBreakfast = breakfastAmount * feeBreakfast;
                                        <tr>
                                            <td>Breakfast</td>
                                            <td class="text-center">@breakfastAmount</td>
                                            <td class="text-center">@feeBreakfast.ToString("F2")</td>
                                            <td class="text-end">@totalBreakfast.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADV_TRANSPORT.HasValue && ViewBag.FEE_TRANSPORT != null)
                                    {
                                        decimal transportAmount = advance.ADV_TRANSPORT.Value;
                                        decimal feeTransport = (decimal)ViewBag.FEE_TRANSPORT;
                                        <tr>
                                            <td>Transport</td>
                                            <td class="text-center">@transportAmount</td>
                                            <td class="text-center">@feeTransport.ToString("F2")</td>
                                            <td class="text-end">@((transportAmount * feeTransport).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_ACCOMMODATION_RES.HasValue && ViewBag.FEE_ACCOMMODATION_RES != null)
                                    {
                                        decimal accommodationResAmount = advance.ADV_ACCOMMODATION_RES.Value;
                                        decimal feeAccommodationRes = (decimal)ViewBag.FEE_ACCOMMODATION_RES;
                                        <tr>
                                            <td>Accommodation (Res)</td>
                                            <td class="text-center">@accommodationResAmount</td>
                                            <td class="text-center">@feeAccommodationRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationResAmount * feeAccommodationRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_ACCOMMODATION_NONRES.HasValue && ViewBag.FEE_ACCOMMODATION_NONRES != null)
                                    {
                                        decimal accommodationNonResAmount = advance.ADV_ACCOMMODATION_NONRES.Value;
                                        decimal feeAccommodationNonRes = (decimal)ViewBag.FEE_ACCOMMODATION_NONRES;
                                        <tr>
                                            <td>Accommodation (Non-Res)</td>
                                            <td class="text-center">@accommodationNonResAmount</td>
                                            <td class="text-center">@feeAccommodationNonRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationNonResAmount * feeAccommodationNonRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_LUNCH.HasValue && ViewBag.FEE_LUNCH != null)
                                    {
                                        decimal lunchAmount = advance.ADV_LUNCH.Value;
                                        decimal feeLunch = (decimal)ViewBag.FEE_LUNCH;
                                        <tr>
                                            <td>Lunch</td>
                                            <td class="text-center">@lunchAmount</td>
                                            <td class="text-center">@feeLunch.ToString("F2")</td>
                                            <td class="text-end">@((lunchAmount * feeLunch).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_DINNER.HasValue && ViewBag.FEE_DINNER != null)
                                    {
                                        decimal dinnerAmount = advance.ADV_DINNER.Value;
                                        decimal feeDinner = (decimal)ViewBag.FEE_DINNER;
                                        <tr>
                                            <td>Dinner</td>
                                            <td class="text-center">@dinnerAmount</td>
                                            <td class="text-center">@feeDinner.ToString("F2")</td>
                                            <td class="text-end">@((dinnerAmount * feeDinner).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADV_OVERNIGHTALLOWANCE.HasValue && ViewBag.FEE_OVERNIGHTALLOWANCE != null)
                                    {
                                        decimal overnightAllowanceAmount = advance.ADV_OVERNIGHTALLOWANCE.Value;
                                        decimal feeOvernightAllowance = (decimal)ViewBag.FEE_OVERNIGHTALLOWANCE;
                                        <tr>
                                            <td>Overnight Allowance</td>
                                            <td class="text-center">@overnightAllowanceAmount</td>
                                            <td class="text-center">@feeOvernightAllowance.ToString("F2")</td>
                                            <td class="text-end">@((overnightAllowanceAmount * feeOvernightAllowance).ToString("F2"))</td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="4" class="text-center">No data available</td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3" class="text-end fw-bold">Total</td>
                                    <td class="text-end fw-bold">@ViewBag.TandSAdvance?.ADV_TOTAL?.ToString("F2")</td>
                                </tr>
                            </tfoot>
                        </table>

                    </div>

                </div>

                <div class="card border-light shadow-sm rounded">
                    <div class="container py-3">
                        <label class="mb-3 custom-label-note fw-bold">Uploaded Files</label>
                        @if (ViewBag.TandSFile != null && (ViewBag.TandSFile as IEnumerable<TandSFile>).Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var file in ViewBag.TandSFile as IEnumerable<TandSFile>)
                                {
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div class="d-flex align-items-center">
                                            @{
                                                var fileExtension = System.IO.Path.GetExtension(file.FileName).ToLower();
                                                var iconClass = "fa-file";
                                                switch (fileExtension)
                                                {
                                                    case ".pdf":
                                                        iconClass = "fa-file-pdf text-danger";
                                                        break;
                                                    case ".doc":
                                                    case ".docx":
                                                        iconClass = "fa-file-word text-primary";
                                                        break;
                                                    case ".xls":
                                                    case ".xlsx":
                                                        iconClass = "fa-file-excel text-success";
                                                        break;
                                                    case ".jpg":
                                                    case ".jpeg":
                                                    case ".png":
                                                        iconClass = "fa-file-image text-warning";
                                                        break;
                                                    default:
                                                        iconClass = "fa-file text-secondary";
                                                        break;
                                                }
                                            }
                                            <i class="fas @iconClass fa-2x me-3"></i>
                                            <div>
                                                <span class="fw-semibold">@file.FileName</span>
                                                <p class="text-muted small mb-0">Currency: @file.Currency</p>
                                            </div>
                                        </div>
                                        <a href="@Url.Action("DownloadFile", "TandS", new { fileName = file.FileName })" class="btn btn-sm btn-primary">
                                            <i class="fas fa-download"></i> Download
                                        </a>
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <p class="text-center text-muted fst-italic">No files available.</p>
                        }
                    </div>
                </div>

                <div class="container my-4">
                    <div class="d-flex justify-content-end align-items-center py-3 px-4 bg-light shadow-sm rounded">
                        <span class="text-secondary fw-bold me-2">Overall Total:</span>
                        <span class="text-primary fw-bold">
                            @String.Format("{0:C}", Model.EMS_TOTAL)
                        </span>
                    </div>
                </div>


            </div>







            <!-- Table Section -->
            <div class="card border-light shadow-sm rounded  text-white  mt-3" style="background-color:grey">
                <div class="card-header bg-secondary text-white">
                    <h6 class="mb-0">Accounts Adjusted Travelling and Subsistence Claim Details</h6>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm text-white">
                        <thead class="thead-dark">
                            <tr>
                                <th>Date</th>
                                <th>Departure Time</th>
                                <th>Arrival Time</th>
                                <th>Place (From/To)</th>
                                <th>Busfare</th>
                                <th>Accommodation</th>
                                <th>Lunch</th>
                                <th>Dinner</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                            {


                                foreach (var detail in ViewBag.TandSDetails)
                                {
                                    <tr>
                                        <td>@detail.EMS_DATE</td>
                                        <td>@detail.EMS_DEPARTURE</td>
                                        <td>@detail.EMS_ARRIVAL</td>
                                        <td>@detail.EMS_PLACE</td>
                                        <td>@detail.ADJ_BUSFARE</td>
                                        <td>@detail.ADJ_ACCOMMODATION</td>
                                        <td>@detail.ADJ_LUNCH</td>
                                        <td>@detail.ADJ_DINNER</td>
                                        <td>@detail.ADJ_TOTAL</td>
                                    </tr>


                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="9" class="text-center">No data available</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" class="fw-bold text-right">Total Expenses</td>
                                <td style="font-weight:bold;">@ViewBag.TotalAdjBusfare</td>
                                <td style="font-weight:bold;">@ViewBag.TotalAdjAccommodation</td>
                                <td style="font-weight:bold;">@ViewBag.TotalAdjLunch</td>
                                <td style="font-weight:bold;">@ViewBag.TotalAdjDinner</td>
                                <td style="font-weight:bold;">@ViewBag.TotalAdjTotal</td>
                            </tr>
                            <tr>
                                <td colspan="9" class="fw-bold">Less advances/prepayments received in respect of this claim</td>
                            </tr>
                            <tr>
                                <td colspan="8" class="fw-bold text-right">Amount Due to Employee</td>
                                <td class="fw-bold">@ViewBag.TotalAdjTotal</td>
                            </tr>
                        </tfoot>
                    </table>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped table-hover mt-5 text-white">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Product</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-center">Unit Price</th>
                                    <th class="text-end">Price</th>
                                </tr>
                            </thead>
                            <tbody class="text-white">
                                @if (ViewBag.TandSAdvance != null)
                                {
                                    var advance = ViewBag.TandSAdvance as TandSAdvance;

                                    if (advance.ADJ_ADV_TEAS.HasValue && ViewBag.FEE_TEA != null)
                                    {
                                        decimal teasAmount = advance.ADJ_ADV_TEAS.Value;
                                        decimal feeTea = (decimal)ViewBag.FEE_TEA;
                                        decimal totalTeas = teasAmount * feeTea;
                                        <tr>
                                            <td>Teas</td>
                                            <td class="text-center">@teasAmount</td>
                                            <td class="text-center">@feeTea.ToString("F2")</td>
                                            <td class="text-end">@totalTeas.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_BREAKFAST.HasValue && ViewBag.FEE_BREAKFAST != null)
                                    {
                                        decimal breakfastAmount = advance.ADJ_ADV_BREAKFAST.Value;
                                        decimal feeBreakfast = (decimal)ViewBag.FEE_BREAKFAST;
                                        decimal totalBreakfast = breakfastAmount * feeBreakfast;
                                        <tr class="text-white">
                                            <td>Breakfast</td>
                                            <td class="text-center">@breakfastAmount</td>
                                            <td class="text-center">@feeBreakfast.ToString("F2")</td>
                                            <td class="text-end">@totalBreakfast.ToString("F2")</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_TRANSPORT.HasValue && ViewBag.FEE_TRANSPORT != null)
                                    {
                                        decimal transportAmount = advance.ADJ_ADV_TRANSPORT.Value;
                                        decimal feeTransport = (decimal)ViewBag.FEE_TRANSPORT;
                                        <tr class="text-white">
                                            <td>Transport</td>
                                            <td class="text-center">@transportAmount</td>
                                            <td class="text-center">@feeTransport.ToString("F2")</td>
                                            <td class="text-end">@((transportAmount * feeTransport).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_ACCOMMODATION_RES.HasValue && ViewBag.FEE_ACCOMMODATION_RES != null)
                                    {
                                        decimal accommodationResAmount = advance.ADJ_ADV_ACCOMMODATION_RES.Value;
                                        decimal feeAccommodationRes = (decimal)ViewBag.FEE_ACCOMMODATION_RES;
                                        <tr class="text-white">
                                            <td>Accommodation (Res)</td>
                                            <td class="text-center">@accommodationResAmount</td>
                                            <td class="text-center">@feeAccommodationRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationResAmount * feeAccommodationRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_ACCOMMODATION_NONRES.HasValue && ViewBag.FEE_ACCOMMODATION_NONRES != null)
                                    {
                                        decimal accommodationNonResAmount = advance.ADJ_ADV_ACCOMMODATION_NONRES.Value;
                                        decimal feeAccommodationNonRes = (decimal)ViewBag.FEE_ACCOMMODATION_NONRES;
                                        <tr class="text-white">
                                            <td>Accommodation (Non-Res)</td>
                                            <td class="text-center">@accommodationNonResAmount</td>
                                            <td class="text-center">@feeAccommodationNonRes.ToString("F2")</td>
                                            <td class="text-end">@((accommodationNonResAmount * feeAccommodationNonRes).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_LUNCH.HasValue && ViewBag.FEE_LUNCH != null)
                                    {
                                        decimal lunchAmount = advance.ADJ_ADV_LUNCH.Value;
                                        decimal feeLunch = (decimal)ViewBag.FEE_LUNCH;
                                        <tr class="text-white">
                                            <td>Lunch</td>
                                            <td class="text-center">@lunchAmount</td>
                                            <td class="text-center">@feeLunch.ToString("F2")</td>
                                            <td class="text-end">@((lunchAmount * feeLunch).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_DINNER.HasValue && ViewBag.FEE_DINNER != null)
                                    {
                                        decimal dinnerAmount = advance.ADJ_ADV_DINNER.Value;
                                        decimal feeDinner = (decimal)ViewBag.FEE_DINNER;
                                        <tr class="text-white">
                                            <td>Dinner</td>
                                            <td class="text-center">@dinnerAmount</td>
                                            <td class="text-center">@feeDinner.ToString("F2")</td>
                                            <td class="text-end">@((dinnerAmount * feeDinner).ToString("F2"))</td>
                                        </tr>
                                    }

                                    if (advance.ADJ_ADV_OVERNIGHTALLOWANCE.HasValue && ViewBag.FEE_OVERNIGHTALLOWANCE != null)
                                    {
                                        decimal overnightAllowanceAmount = advance.ADJ_ADV_OVERNIGHTALLOWANCE.Value;
                                        decimal feeOvernightAllowance = (decimal)ViewBag.FEE_OVERNIGHTALLOWANCE;
                                        <tr class="text-white">
                                            <td>Overnight Allowance</td>
                                            <td class="text-center">@overnightAllowanceAmount</td>
                                            <td class="text-center">@feeOvernightAllowance.ToString("F2")</td>
                                            <td class="text-end">@((overnightAllowanceAmount * feeOvernightAllowance).ToString("F2"))</td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="4" class="text-center">No data available</td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3" class="text-end fw-bold">Total</td>
                                    <td class="text-end fw-bold">@ViewBag.TandSAdvance?.ADJ_ADV_TOTAL?.ToString("F2")</td>
                                </tr>
                            </tfoot>
                        </table>

                    </div>

                </div>
            </div>



            <div class="container my-4">
                <div class="d-flex justify-content-end align-items-center py-3 px-4 bg-light shadow-sm rounded" style="background-color:grey;">
                    <span class="text-secondary fw-bold  me-2">Accounts Adjusted Overall Total:</span>
                    <span class="text-primary fw-bold ">
                        @String.Format("{0:C}", Model.ADJ_TOTAL)
                    </span>
                </div>
            </div>





        </div>

        @if (User.IsInRole("Accounts"))
        {

            <div class="containera" style="margin-bottom: 50px;">
                <div class="container">
                    <div class="timeline">
                        <div class="timeline-header">Timeline</div>

                         @if (@Model.SUBJECT_MANAGER_STATUS != null)
            {
            <div class="containera">
            <div class="timeline-item">
            <span class="timeline-label">Status By:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_STATUS_BY</span>
            </div>
            <div class="timeline-item">
            <span class="timeline-label">Date:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_DATE</span>
            </div>
            @if (@Model.SUBJECT_MANAGER_STATUS == "Recommended")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:green;">Approved</span>
            </div>
            }
            else if (@Model.SUBJECT_MANAGER_STATUS == "Rejected")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:red;">@Model.SUBJECT_MANAGER_STATUS</span>
            </div>
            }
            <div class="timeline-item">
            <span class="timeline-label">Comment:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_COMMENT</span>
            </div>
            </div>
            }

                        @if (@Model.CENTRE_SUPERVISOR_STATUS != null)
                        {
                            <div class="containera">
                                <div class="timeline-item">
                                    <span class="timeline-label">Status By:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_STATUS_BY</span>
                                </div>
                                <div class="timeline-item">
                                    <span class="timeline-label">Date:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_DATE</span>
                                </div>
                                @if (@Model.CENTRE_SUPERVISOR_STATUS == "Approved")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:green;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                    </div>
                                }
                                else if (@Model.CENTRE_SUPERVISOR_STATUS == "Rejected")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:red;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                    </div>
                                }

                                <div class="timeline-item">
                                    <span class="timeline-label">Comment:</span>
                                    <span class="timeline-content">@Model.CENTRE_SUPERVISOR_COMMENT</span>
                                </div>
                            </div>
                        }





                        @if (@Model.ACCOUNTS_STATUS != null && Model.ACCOUNTS_STATUS == "Approved")
                        {
                            <div class="containera mt-2">
                                <div class="timeline-item">
                                    <span class="timeline-label">Status By:</span>
                                    <span class="timeline-content">@Model.ACCOUNTS_STATUS_BY</span>
                                </div>
                                <div class="timeline-item">
                                    <span class="timeline-label">Date:</span>
                                    <span class="timeline-content">@Model.ACCOUNTS_DATE</span>
                                </div>
                                @if (@Model.ACCOUNTS_STATUS == "Approved")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:green;">@Model.ACCOUNTS_STATUS</span>
                                    </div>
                                }
                            </div>
                        }

                        @if (@Model.ACCOUNTS_REVIEW != null && Model.ACCOUNTS_REVIEW == "Approved")
                        {
                            <div class="containera">
                                <div class="timeline-item">
                                    <span class="timeline-label">Status By:</span>
                                    <span class="timeline-content">@Model.ACCOUNTS_REVIEW_BY</span>
                                </div>
                                <div class="timeline-item">
                                    <span class="timeline-label">Date:</span>
                                    <span class="timeline-content">@Model.ACCOUNTS_REVIEW_DATE</span>
                                </div>
                                @if (@Model.ACCOUNTS_REVIEW == "Approved")
                                {
                                    <div class="timeline-item">
                                        <span class="timeline-label">Status:</span>
                                        <span class="timeline-content" style="color:green;">@Model.ACCOUNTS_REVIEW</span>
                                    </div>
                                }
                            </div>
                        }



                    </div>
                </div>

            </div>

        }



    }

}
else if (User.IsInRole("PeerReviewer") || User.IsInRole("AssistantAccountant") || User.IsInRole("Admin") || User.IsInRole("SuperAdmin"))
{
    @if (Model.ACCOUNTS_REVIEW == "Pending")
    {
        <div class="container py-3 mb-3  rounded-3 shadow-sm border" style="padding: 30px;">

            <div class="container d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    @if (User.IsInRole("PeerReviewer") || User.IsInRole("AssistantAccountant"))
                    {
                        <button class="btn btn-primary me-2 px-3 py-2 d-flex align-items-center text-white"
                                style="border-radius: 50px; background-color: #153355; transition: background-color 0.3s;"
                                onclick="approveClaim()">
                            <i class="fas fa-check-circle me-2"></i> Approve
                        </button>
                        <button class="btn btn-primary px-3 py-2 d-flex align-items-center text-white"
                                style="border-radius: 50px; background-color: red; transition: background-color 0.3s;"
                                onclick="returnClaim()">
                            <i class="fas fa-times-circle me-2"></i> Return Back
                        </button>
                    }
                </div>
                <div>
                    <a class="btn btn-primary px-3 py-2 d-flex align-items-center text-white"
                       style="border-radius: 50px; background-color: #153355; transition: background-color 0.3s;"
                       asp-controller="TandS" asp-action="ApprovalList">
                        <i class="fas fa-arrow-left me-2"></i> Back To List
                    </a>
                </div>
            </div>

        </div>


    }
    else
    {
        <div class="containera d-flex justify-content-end">

            <div>
                <a class="btn btn-primary px-3 py-2 d-flex align-items-center text-white"
                   style="border-radius: 50px; background-color: #153355; transition: background-color 0.3s;" asp-controller="Transcribers" asp-action="TandSAccountsList">
                    <i class="fas fa-arrow-left"></i> Back To List
                </a>
            </div>
        </div>
    }

    <div class="container py-3  mb-3 rounded-3 shadow-sm border" style="padding: 30px;">
        <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="created-date" style="font-size: 0.9rem; color: #666;">
            Created Date: @Model.Date
        </div>
        <div class="header">
            <h4 class="font-weight-bold text-center">Travelling and Subsistence Claim Report</h4>
        </div>
        <div style="width: 100px;">&nbsp;</div> <!-- Spacer for alignment -->
    </div>


        <div class="card p-2 mb-3 shadow-sm border">
            <div class="row">
                <div class="col-md-9 mb-3">
                    <div class="card p-1 shadow-sm border rounded">
                        <div class="card-header bg-secondary text-white py-1">
                            <h6 class="mb-0 small">Claim Details</h6>
                        </div>
                        <div class="card-body p-2">
                            <div class="row">
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Full Name:</span>
                                    <span class="small">@Model.EMS_EXAMINER_NAME @Model.EMS_LAST_NAME</span>
                                </div>
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">National ID:</span>
                                    <span class="small">@Model.EMS_NATIONAL_ID</span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Subject:</span>
                                    <span class="small">@Model.EMS_SUB_SUB_ID / @Model.EMS_PAPER_CODE</span>
                                </div>
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Level:</span>
                                    <span class="small">@Model.EMS_LEVEL_OF_EXAM_MARKED</span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Bank (NOSTRO):</span>
                                    <span class="small">@Model.EMS_BANK_NAME_FCA</span>
                                </div>
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Account No. (NOSTRO):</span>
                                    <span class="small">@Model.EMS_ACCOUNT_NO_FCA</span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Bank (ZWG):</span>
                                    <span class="small">@Model.EMS_BANK_NAME_ZWL</span>
                                </div>
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Account No. (ZWG):</span>
                                    <span class="small">@Model.EMS_ACCOUNT_NO_ZWL</span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Purpose:</span>
                                    <span class="small">@Model.EMS_PURPOSEOFJOURNEY</span>
                                </div>
                                <div class="col-md-6 mb-1 d-flex">
                                    <span class="fw-bold small w-50">Venue:</span>
                                    <span class="small">@Model.EMS_VENUE</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Work Address and Contact Section -->
                <div class="col-md-3 mb-4">
                    <div class="card p-2 shadow-sm border rounded">
                        <div class="card-body">
                            <h6 class="fw-bold text-primary">
                                <i class="fa fa-map-marker-alt"></i> Work Address
                            </h6>
                            <p class="mb-1 small"><i class="fa fa-home"></i> @Model.EMS_WORK_ADD1</p>
                            <p class="mb-1 small"><i class="fa fa-city"></i> @Model.EMS_WORK_ADD2</p>
                            <p class="mb-3 small"><i class="fa fa-building"></i> @Model.EMS_WORK_ADD3</p>

                            <h6 class="fw-bold text-primary">
                                <i class="fa fa-phone"></i> Contact
                            </h6>
                            <p class="mb-0 small"><i class="fa fa-phone-alt"></i> @Model.EMS_PHONE_HOME</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>






        <div class="card border-light shadow-sm rounded">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0">Travelling and Subsistence Claim Details</h6>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered table-sm">
                    <thead class="thead-dark">
                        <tr>
                            <th>Date</th>
                            <th>Departure Time</th>
                            <th>Arrival Time</th>
                            <th>Place (From/To)</th>
                            <th>Busfare</th>
                            <th>Accommodation</th>
                            <th>Lunch</th>
                            <th>Dinner</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                        {
                            foreach (var detail in ViewBag.TandSDetails)
                            {
                                <tr>
                                    <td>@detail.EMS_DATE</td>
                                    <td>@detail.EMS_DEPARTURE</td>
                                    <td>@detail.EMS_ARRIVAL</td>
                                    <td>@detail.EMS_PLACE</td>
                                    <td>@detail.EMS_BUSFARE</td>
                                    <td>@detail.EMS_ACCOMMODATION</td>
                                    <td>@detail.EMS_LUNCH</td>
                                    <td>@detail.EMS_DINNER</td>
                                    <td>@detail.EMS_TOTAL</td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="9" class="text-center">No data available</td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4" class="fw-bold text-right">Total Expenses</td>
                            <td class="fw-bold">@ViewBag.TotalBusfare</td>
                            <td class="fw-bold">@ViewBag.TotalAccommodation</td>
                            <td class="fw-bold">@ViewBag.TotalLunch</td>
                            <td class="fw-bold">@ViewBag.TotalDinner</td>
                            <td class="fw-bold">@ViewBag.TotalTotal</td>
                        </tr>
                        <tr>
                            <td colspan="9" class="fw-bold">Less advances/prepayments received in respect of this claim</td>
                        </tr>
                        <tr>
                            <td colspan="8" class="fw-bold text-right">Amount Due to Employee</td>
                            <td class="fw-bold">@ViewBag.TotalTotal</td>
                        </tr>
                    </tfoot>
                </table>

                <div class="table-responsive">
                    <table class="table table-bordered table-striped table-hover mt-5">
                        <thead class="thead-dark">
                            <tr>
                                <th>Product</th>
                                <th class="text-center">Qty</th>
                                <th class="text-center">Unit Price</th>
                                <th class="text-end">Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.TandSAdvance != null)
                            {
                                var advance = ViewBag.TandSAdvance as TandSAdvance;

                                if (advance.ADV_TEAS.HasValue && ViewBag.FEE_TEA != null)
                                {
                                    decimal teasAmount = advance.ADV_TEAS.Value;
                                    decimal feeTea = (decimal)ViewBag.FEE_TEA;
                                    decimal totalTeas = teasAmount * feeTea;
                                    <tr>
                                        <td>Teas</td>
                                        <td class="text-center">@teasAmount</td>
                                        <td class="text-center">@feeTea.ToString("F2")</td>
                                        <td class="text-end">@totalTeas.ToString("F2")</td>
                                    </tr>
                                }

                                if (advance.ADV_BREAKFAST.HasValue && ViewBag.FEE_BREAKFAST != null)
                                {
                                    decimal breakfastAmount = advance.ADV_BREAKFAST.Value;
                                    decimal feeBreakfast = (decimal)ViewBag.FEE_BREAKFAST;
                                    decimal totalBreakfast = breakfastAmount * feeBreakfast;
                                    <tr>
                                        <td>Breakfast</td>
                                        <td class="text-center">@breakfastAmount</td>
                                        <td class="text-center">@feeBreakfast.ToString("F2")</td>
                                        <td class="text-end">@totalBreakfast.ToString("F2")</td>
                                    </tr>
                                }

                                if (advance.ADV_TRANSPORT.HasValue && ViewBag.FEE_TRANSPORT != null)
                                {
                                    decimal transportAmount = advance.ADV_TRANSPORT.Value;
                                    decimal feeTransport = (decimal)ViewBag.FEE_TRANSPORT;
                                    <tr>
                                        <td>Transport</td>
                                        <td class="text-center">@transportAmount</td>
                                        <td class="text-center">@feeTransport.ToString("F2")</td>
                                        <td class="text-end">@((transportAmount * feeTransport).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADV_ACCOMMODATION_RES.HasValue && ViewBag.FEE_ACCOMMODATION_RES != null)
                                {
                                    decimal accommodationResAmount = advance.ADV_ACCOMMODATION_RES.Value;
                                    decimal feeAccommodationRes = (decimal)ViewBag.FEE_ACCOMMODATION_RES;
                                    <tr>
                                        <td>Accommodation (Res)</td>
                                        <td class="text-center">@accommodationResAmount</td>
                                        <td class="text-center">@feeAccommodationRes.ToString("F2")</td>
                                        <td class="text-end">@((accommodationResAmount * feeAccommodationRes).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADV_ACCOMMODATION_NONRES.HasValue && ViewBag.FEE_ACCOMMODATION_NONRES != null)
                                {
                                    decimal accommodationNonResAmount = advance.ADV_ACCOMMODATION_NONRES.Value;
                                    decimal feeAccommodationNonRes = (decimal)ViewBag.FEE_ACCOMMODATION_NONRES;
                                    <tr>
                                        <td>Accommodation (Non-Res)</td>
                                        <td class="text-center">@accommodationNonResAmount</td>
                                        <td class="text-center">@feeAccommodationNonRes.ToString("F2")</td>
                                        <td class="text-end">@((accommodationNonResAmount * feeAccommodationNonRes).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADV_LUNCH.HasValue && ViewBag.FEE_LUNCH != null)
                                {
                                    decimal lunchAmount = advance.ADV_LUNCH.Value;
                                    decimal feeLunch = (decimal)ViewBag.FEE_LUNCH;
                                    <tr>
                                        <td>Lunch</td>
                                        <td class="text-center">@lunchAmount</td>
                                        <td class="text-center">@feeLunch.ToString("F2")</td>
                                        <td class="text-end">@((lunchAmount * feeLunch).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADV_DINNER.HasValue && ViewBag.FEE_DINNER != null)
                                {
                                    decimal dinnerAmount = advance.ADV_DINNER.Value;
                                    decimal feeDinner = (decimal)ViewBag.FEE_DINNER;
                                    <tr>
                                        <td>Dinner</td>
                                        <td class="text-center">@dinnerAmount</td>
                                        <td class="text-center">@feeDinner.ToString("F2")</td>
                                        <td class="text-end">@((dinnerAmount * feeDinner).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADV_OVERNIGHTALLOWANCE.HasValue && ViewBag.FEE_OVERNIGHTALLOWANCE != null)
                                {
                                    decimal overnightAllowanceAmount = advance.ADV_OVERNIGHTALLOWANCE.Value;
                                    decimal feeOvernightAllowance = (decimal)ViewBag.FEE_OVERNIGHTALLOWANCE;
                                    <tr>
                                        <td>Overnight Allowance</td>
                                        <td class="text-center">@overnightAllowanceAmount</td>
                                        <td class="text-center">@feeOvernightAllowance.ToString("F2")</td>
                                        <td class="text-end">@((overnightAllowanceAmount * feeOvernightAllowance).ToString("F2"))</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="4" class="text-center">No data available</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-end fw-bold">Total</td>
                                <td class="text-end fw-bold">@ViewBag.TandSAdvance?.ADV_TOTAL?.ToString("F2")</td>
                            </tr>
                        </tfoot>
                    </table>

                </div>

            </div>

            <div class="card border-light shadow-sm rounded">
                <div class="container py-3">
                    <label class="mb-3 custom-label-note fw-bold">Uploaded Files</label>
                    @if (ViewBag.TandSFile != null && (ViewBag.TandSFile as IEnumerable<TandSFile>).Any())
                    {
                        <ul class="list-group list-group-flush">
                            @foreach (var file in ViewBag.TandSFile as IEnumerable<TandSFile>)
                            {
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        @{
                                            var fileExtension = System.IO.Path.GetExtension(file.FileName).ToLower();
                                            var iconClass = "fa-file";
                                            switch (fileExtension)
                                            {
                                                case ".pdf":
                                                    iconClass = "fa-file-pdf text-danger";
                                                    break;
                                                case ".doc":
                                                case ".docx":
                                                    iconClass = "fa-file-word text-primary";
                                                    break;
                                                case ".xls":
                                                case ".xlsx":
                                                    iconClass = "fa-file-excel text-success";
                                                    break;
                                                case ".jpg":
                                                case ".jpeg":
                                                case ".png":
                                                    iconClass = "fa-file-image text-warning";
                                                    break;
                                                default:
                                                    iconClass = "fa-file text-secondary";
                                                    break;
                                            }
                                        }
                                        <i class="fas @iconClass fa-2x me-3"></i>
                                        <div>
                                            <span class="fw-semibold">@file.FileName</span>
                                            <p class="text-muted small mb-0">Currency: @file.Currency</p>
                                        </div>
                                    </div>
                                    <a href="@Url.Action("DownloadFile", "TandS", new { fileName = file.FileName })" class="btn btn-sm btn-primary">
                                        <i class="fas fa-download"></i> Download
                                    </a>
                                </li>
                            }
                        </ul>
                    }
                    else
                    {
                        <p class="text-center text-muted fst-italic">No files available.</p>
                    }
                </div>
            </div>

            <div class="container my-4">
                <div class="d-flex justify-content-end align-items-center py-3 px-4 bg-light shadow-sm rounded">
                    <span class="text-secondary fw-bold me-2">Overall Total:</span>
                    <span class="text-primary fw-bold">
                        @String.Format("{0:C}", Model.EMS_TOTAL)
                    </span>
                </div>
            </div>


        </div>







        <!-- Table Section -->
        <div class="card border-light shadow-sm rounded  text-white  mt-3" style="background-color:grey">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0">Accounts Adjusted Travelling and Subsistence Claim Details</h6>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered table-sm text-white">
                    <thead class="thead-dark">
                        <tr>
                            <th>Date</th>
                            <th>Departure Time</th>
                            <th>Arrival Time</th>
                            <th>Place (From/To)</th>
                            <th>Busfare</th>
                            <th>Accommodation</th>
                            <th>Lunch</th>
                            <th>Dinner</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (ViewBag.TandSDetails != null && ViewBag.TandSDetails.Count > 0)
                        {


                            foreach (var detail in ViewBag.TandSDetails)
                            {
                                <tr>
                                    <td>@detail.EMS_DATE</td>
                                    <td>@detail.EMS_DEPARTURE</td>
                                    <td>@detail.EMS_ARRIVAL</td>
                                    <td>@detail.EMS_PLACE</td>
                                    <td>@detail.ADJ_BUSFARE</td>
                                    <td>@detail.ADJ_ACCOMMODATION</td>
                                    <td>@detail.ADJ_LUNCH</td>
                                    <td>@detail.ADJ_DINNER</td>
                                    <td>@detail.ADJ_TOTAL</td>
                                </tr>


                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="9" class="text-center">No data available</td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4" class="fw-bold text-right">Total Expenses</td>
                            <td style="font-weight:bold;">@ViewBag.TotalAdjBusfare</td>
                            <td style="font-weight:bold;">@ViewBag.TotalAdjAccommodation</td>
                            <td style="font-weight:bold;">@ViewBag.TotalAdjLunch</td>
                            <td style="font-weight:bold;">@ViewBag.TotalAdjDinner</td>
                            <td style="font-weight:bold;">@ViewBag.TotalAdjTotal</td>
                        </tr>
                        <tr>
                            <td colspan="9" class="fw-bold">Less advances/prepayments received in respect of this claim</td>
                        </tr>
                        <tr>
                            <td colspan="8" class="fw-bold text-right">Amount Due to Employee</td>
                            <td class="fw-bold">@ViewBag.TotalAdjTotal</td>
                        </tr>
                    </tfoot>
                </table>

                <div class="table-responsive">
                    <table class="table table-bordered table-striped table-hover mt-5 text-white">
                        <thead class="thead-dark">
                            <tr>
                                <th>Product</th>
                                <th class="text-center">Qty</th>
                                <th class="text-center">Unit Price</th>
                                <th class="text-end">Price</th>
                            </tr>
                        </thead>
                        <tbody class="text-white">
                            @if (ViewBag.TandSAdvance != null)
                            {
                                var advance = ViewBag.TandSAdvance as TandSAdvance;

                                if (advance.ADJ_ADV_TEAS.HasValue && ViewBag.FEE_TEA != null)
                                {
                                    decimal teasAmount = advance.ADJ_ADV_TEAS.Value;
                                    decimal feeTea = (decimal)ViewBag.FEE_TEA;
                                    decimal totalTeas = teasAmount * feeTea;
                                    <tr>
                                        <td>Teas</td>
                                        <td class="text-center">@teasAmount</td>
                                        <td class="text-center">@feeTea.ToString("F2")</td>
                                        <td class="text-end">@totalTeas.ToString("F2")</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_BREAKFAST.HasValue && ViewBag.FEE_BREAKFAST != null)
                                {
                                    decimal breakfastAmount = advance.ADJ_ADV_BREAKFAST.Value;
                                    decimal feeBreakfast = (decimal)ViewBag.FEE_BREAKFAST;
                                    decimal totalBreakfast = breakfastAmount * feeBreakfast;
                                    <tr class="text-white">
                                        <td>Breakfast</td>
                                        <td class="text-center">@breakfastAmount</td>
                                        <td class="text-center">@feeBreakfast.ToString("F2")</td>
                                        <td class="text-end">@totalBreakfast.ToString("F2")</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_TRANSPORT.HasValue && ViewBag.FEE_TRANSPORT != null)
                                {
                                    decimal transportAmount = advance.ADJ_ADV_TRANSPORT.Value;
                                    decimal feeTransport = (decimal)ViewBag.FEE_TRANSPORT;
                                    <tr class="text-white">
                                        <td>Transport</td>
                                        <td class="text-center">@transportAmount</td>
                                        <td class="text-center">@feeTransport.ToString("F2")</td>
                                        <td class="text-end">@((transportAmount * feeTransport).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_ACCOMMODATION_RES.HasValue && ViewBag.FEE_ACCOMMODATION_RES != null)
                                {
                                    decimal accommodationResAmount = advance.ADJ_ADV_ACCOMMODATION_RES.Value;
                                    decimal feeAccommodationRes = (decimal)ViewBag.FEE_ACCOMMODATION_RES;
                                    <tr class="text-white">
                                        <td>Accommodation (Res)</td>
                                        <td class="text-center">@accommodationResAmount</td>
                                        <td class="text-center">@feeAccommodationRes.ToString("F2")</td>
                                        <td class="text-end">@((accommodationResAmount * feeAccommodationRes).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_ACCOMMODATION_NONRES.HasValue && ViewBag.FEE_ACCOMMODATION_NONRES != null)
                                {
                                    decimal accommodationNonResAmount = advance.ADJ_ADV_ACCOMMODATION_NONRES.Value;
                                    decimal feeAccommodationNonRes = (decimal)ViewBag.FEE_ACCOMMODATION_NONRES;
                                    <tr class="text-white">
                                        <td>Accommodation (Non-Res)</td>
                                        <td class="text-center">@accommodationNonResAmount</td>
                                        <td class="text-center">@feeAccommodationNonRes.ToString("F2")</td>
                                        <td class="text-end">@((accommodationNonResAmount * feeAccommodationNonRes).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_LUNCH.HasValue && ViewBag.FEE_LUNCH != null)
                                {
                                    decimal lunchAmount = advance.ADJ_ADV_LUNCH.Value;
                                    decimal feeLunch = (decimal)ViewBag.FEE_LUNCH;
                                    <tr class="text-white">
                                        <td>Lunch</td>
                                        <td class="text-center">@lunchAmount</td>
                                        <td class="text-center">@feeLunch.ToString("F2")</td>
                                        <td class="text-end">@((lunchAmount * feeLunch).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_DINNER.HasValue && ViewBag.FEE_DINNER != null)
                                {
                                    decimal dinnerAmount = advance.ADJ_ADV_DINNER.Value;
                                    decimal feeDinner = (decimal)ViewBag.FEE_DINNER;
                                    <tr class="text-white">
                                        <td>Dinner</td>
                                        <td class="text-center">@dinnerAmount</td>
                                        <td class="text-center">@feeDinner.ToString("F2")</td>
                                        <td class="text-end">@((dinnerAmount * feeDinner).ToString("F2"))</td>
                                    </tr>
                                }

                                if (advance.ADJ_ADV_OVERNIGHTALLOWANCE.HasValue && ViewBag.FEE_OVERNIGHTALLOWANCE != null)
                                {
                                    decimal overnightAllowanceAmount = advance.ADJ_ADV_OVERNIGHTALLOWANCE.Value;
                                    decimal feeOvernightAllowance = (decimal)ViewBag.FEE_OVERNIGHTALLOWANCE;
                                    <tr class="text-white">
                                        <td>Overnight Allowance</td>
                                        <td class="text-center">@overnightAllowanceAmount</td>
                                        <td class="text-center">@feeOvernightAllowance.ToString("F2")</td>
                                        <td class="text-end">@((overnightAllowanceAmount * feeOvernightAllowance).ToString("F2"))</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="4" class="text-center">No data available</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-end fw-bold">Total</td>
                                <td class="text-end fw-bold">@ViewBag.TandSAdvance?.ADV_TOTAL?.ToString("F2")</td>
                            </tr>
                        </tfoot>
                    </table>

                </div>

            </div>
        </div>



        <div class="container my-4">
            <div class="d-flex justify-content-end align-items-center py-3 px-4 bg-light shadow-sm rounded" style="background-color:grey;">
                <span class="text-secondary fw-bold  me-2">Accounts Adjusted Overall Total:</span>
                <span class="text-primary fw-bold ">
                    @String.Format("{0:C}", Model.ADJ_TOTAL)
                </span>
            </div>
        </div>





    </div>




    @if (User.IsInRole("Accounts") || User.IsInRole("PeerReviewer"))
    {

        <div class="containera mb-5">
            <div class="container">
                <div class="timeline">
                    <div class="timeline-header">Timeline</div>

                        @if (@Model.SUBJECT_MANAGER_STATUS != null)
            {
            <div class="containera">
            <div class="timeline-item">
            <span class="timeline-label">Status By:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_STATUS_BY</span>
            </div>
            <div class="timeline-item">
            <span class="timeline-label">Date:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_DATE</span>
            </div>
            @if (@Model.SUBJECT_MANAGER_STATUS == "Recommended")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:green;">Approved</span>
            </div>
            }
            else if (@Model.SUBJECT_MANAGER_STATUS == "Rejected")
            {
            <div class="timeline-item">
            <span class="timeline-label">Status:</span>
            <span class="timeline-content" style="color:red;">@Model.SUBJECT_MANAGER_STATUS</span>
            </div>
            }
            <div class="timeline-item">
            <span class="timeline-label">Comment:</span>
            <span class="timeline-content">@Model.SUBJECT_MANAGER_COMMENT</span>
            </div>
            </div>
            }
         
                    @if (@Model.CENTRE_SUPERVISOR_STATUS != null)
                    {
                        <div class="containera">
                            <div class="timeline-item">
                                <span class="timeline-label">Status By:</span>
                                <span class="timeline-content">@Model.CENTRE_SUPERVISOR_STATUS_BY</span>
                            </div>
                            <div class="timeline-item">
                                <span class="timeline-label">Date:</span>
                                <span class="timeline-content">@Model.CENTRE_SUPERVISOR_DATE</span>
                            </div>
                            @if (@Model.CENTRE_SUPERVISOR_STATUS == "Approved")
                            {
                                <div class="timeline-item">
                                    <span class="timeline-label">Status:</span>
                                    <span class="timeline-content" style="color:green;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                </div>
                            }
                            else if (@Model.CENTRE_SUPERVISOR_STATUS == "Rejected")
                            {
                                <div class="timeline-item">
                                    <span class="timeline-label">Status:</span>
                                    <span class="timeline-content" style="color:red;">@Model.CENTRE_SUPERVISOR_STATUS</span>
                                </div>
                            }
                            <div class="timeline-item">
                                <span class="timeline-label">Comment:</span>
                                <span class="timeline-content">@Model.CENTRE_SUPERVISOR_COMMENT</span>
                            </div>
                        </div>
                    }





                    @if (@Model.ACCOUNTS_STATUS != null && Model.ACCOUNTS_STATUS == "Approved")
                    {
                        <div class="containera mt-3">
                            <div class="timeline-item">
                                <span class="timeline-label">Status By:</span>
                                <span class="timeline-content">@Model.ACCOUNTS_STATUS_BY</span>
                            </div>
                            <div class="timeline-item">
                                <span class="timeline-label">Date:</span>
                                <span class="timeline-content">@Model.ACCOUNTS_DATE</span>
                            </div>
                            @if (@Model.ACCOUNTS_STATUS == "Approved")
                            {
                                <div class="timeline-item">
                                    <span class="timeline-label">Status:</span>
                                    <span class="timeline-content" style="color:green;">@Model.ACCOUNTS_STATUS</span>
                                </div>
                            }
                        </div>
                    }

                    @if (@Model.ACCOUNTS_REVIEW != null && Model.ACCOUNTS_REVIEW == "Approved")
                    {
                        <div class="containera mt-3">
                            <div class="timeline-item">
                                <span class="timeline-label">Status By:</span>
                                <span class="timeline-content">@Model.ACCOUNTS_REVIEW_BY</span>
                            </div>
                            <div class="timeline-item">
                                <span class="timeline-label">Date:</span>
                                <span class="timeline-content">@Model.ACCOUNTS_REVIEW_DATE</span>
                            </div>
                            @if (@Model.ACCOUNTS_REVIEW == "Approved")
                            {
                                <div class="timeline-item">
                                    <span class="timeline-label">Status:</span>
                                    <span class="timeline-content" style="color:green;">@Model.ACCOUNTS_REVIEW</span>
                                </div>
                            }
                        </div>
                    }


                </div>
            </div>

        </div>

    }


    @if (User.IsInRole("Accounts"))
    {





    }
    else if (User.IsInRole("PeerReviewer"))
    {

        @section Scripts {
    <script type="text/javascript">
        function approveClaim() {
            Swal.fire({
                title: 'Are you sure?',
                text: "You are about to Review this claim.",
                icon: 'warning',
                input: 'textarea',
                inputPlaceholder: 'Enter your review comment here...',
                showCancelButton: true,
                confirmButtonColor: '#153355',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Submit!',
                // preConfirm: (comment) => {
                //     if (!comment) {
                //         Swal.showValidationMessage('Comment is required');
                //         return false;
                //     }
                //     return comment;
                // }
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("Approve", "Transcribers")',
                        data: {
                            idNumber: '@Model.EMS_NATIONAL_ID',
                            examinerCode: '@Model.EMS_EXAMINER_CODE',
                            tandscode: '@Model.TANDSCODE',
                            subKey: '@Model.EMS_SUBKEY',
                            comment: result.value // Include the comment in the request data
                        },
                        success: function (response) {
                            if (response.success) {
                                Swal.fire('Review!', response.message, 'success').then(() => {
                                    window.location.href = '@Url.Action("TandSAccountsList", "Transcribers")';
                                });
                            } else {
                                Swal.fire('Error!', response.message, 'error');
                            }
                        },
                        error: function () {
                            Swal.fire('Error!', 'An error occurred while processing your request.', 'error');
                        }
                    });
                }
            });
        }


        function rejectClaim() {
            Swal.fire({
                title: 'Are you sure?',
                text: "You are about to reject this claim.",
                icon: 'warning',
                input: 'textarea',
                inputPlaceholder: 'Enter your comment here...',
                showCancelButton: true,
                confirmButtonColor: '#153355',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Submit!',
                preConfirm: (comment) => {
                    if (!comment) {
                        Swal.showValidationMessage('Comment is required');
                        return false;
                    }
                    return comment;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("Reject", "Transcribers")',
                        data: {
                            idNumber: '@Model.EMS_NATIONAL_ID',
                            examinerCode: '@Model.EMS_EXAMINER_CODE',
                            tandscode: '@Model.TANDSCODE',
                            subKey: '@Model.EMS_SUBKEY',
                            comment: result.value // Include the comment in the request data
                        },
                        success: function (response) {
                            if (response.success) {
                                Swal.fire('Rejected!', response.message, 'success').then(() => {
                                    window.location.href = '@Url.Action("TandSAccountsList", "Transcribers")';
                                });
                            } else {
                                Swal.fire('Error!', response.message, 'error');
                            }
                        },
                        error: function () {
                            Swal.fire('Error!', 'An error occurred while processing your request.', 'error');
                        }
                    });
                }
            });
        }


        function returnClaim() {
            Swal.fire({
                title: 'Are you sure?',
                text: "You Are About oT Return  this claim for adjustments.",
                icon: 'warning',
                input: 'textarea',
                inputPlaceholder: 'Enter your comment here...',
                showCancelButton: true,
                confirmButtonColor: '#153355',
                cancelButtonColor: 'red',
                confirmButtonText: 'Yes, Return!',
                preConfirm: (comment) => {
                    if (!comment) {
                        Swal.showValidationMessage('Comment is required');
                        return false;
                    }
                    return comment;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("ReturnTandS", "Transcribers")',
                        data: {
                            idNumber: '@Model.EMS_NATIONAL_ID',
                            examinerCode: '@Model.EMS_EXAMINER_CODE',
                            tandscode: '@Model.TANDSCODE',
                            subKey: '@Model.EMS_SUBKEY',
                            comment: result.value // Include the comment in the request data
                        },
                        success: function (response) {
                            if (response.success) {
                                Swal.fire('Returned!', response.message, 'success').then(() => {
                                    window.location.href = '@Url.Action("TandSAccountsList", "Transcribers")';
                                });
                            } else {
                                Swal.fire('Error!', response.message, 'error');
                            }
                        },
                        error: function () {
                            Swal.fire('Error!', 'An error occurred while processing your request.', 'error');
                        }
                    });
                }
            });
        }


    </script>


        }

    }




}


<script type="text/javascript">


    function rejectClaimm() {
        Swal.fire({
            title: 'Are you sure?',
            text: "You are about to reject this claim.",
            icon: 'warning',
            input: 'textarea',
            inputPlaceholder: 'Enter your comment here...',
            showCancelButton: true,
            confirmButtonColor: '#153355',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Submit!',
            preConfirm: (comment) => {
                if (!comment) {
                    Swal.showValidationMessage('Comment is required');
                    return false;
                }
                return comment;
            }
        }).then((result) => {
            if (result.isConfirmed) {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("Reject", "Transcribers")',
                    data: {
                        idNumber: '@Model.EMS_NATIONAL_ID',
                        examinerCode: '@Model.EMS_EXAMINER_CODE',
                        tandscode: '@Model.TANDSCODE',
                        subKey: '@Model.EMS_SUBKEY',
                        comment: result.value // Include the comment in the request data
                    },
                    success: function (response) {
                        if (response.success) {
                            Swal.fire('Rejected!', response.message, 'success').then(() => {
                                window.location.href = '@Url.Action("TandSaccountsList", "Transcribers")';
                            });
                        } else {
                            Swal.fire('Error!', response.message, 'error');
                        }
                    },
                    error: function () {
                        Swal.fire('Error!', 'An error occurred while processing your request.', 'error');
                    }
                });
            }
        });
    }



</script>
